import{j as e,r as f,P as B}from"./index-33b2785e.js";import{B as R}from"./Breadcrumb-ac18a331.js";import{P as k}from"./PageContainer-3bff8604.js";import{m as v}from"./mapbox-gl-fd1563e7.js";import{D as P}from"./DashboardCard-56d2437b.js";import{C as T,_ as M}from"./react-apexcharts.min-b420d1b8.js";import{B as N}from"./BlankCard-904d32fe.js";import{u as E,B as C,T as x,G as o,O as z,S as K,s as W}from"./index.esm-77ed05ce.js";import{C as F}from"./Chip-53e51d90.js";import{S as w}from"./Stack-3c2152a3.js";import{A as J}from"./Avatar-5877fa00.js";import{b as L}from"./Button-5375a383.js";import{C as G}from"./CustomerMetrics-f2344cc4.js";import"./CustomSelect-091296db.js";import"./Grow-2601ff12.js";import"./ButtonBase-49a1dc58.js";import"./Card-4e02e502.js";import"./styled-c3323930.js";const u=({title:i,value:n,chartData:t,stateName:l})=>{const s=E(),h=(c=>{if(c.length<2)return"0%";const a=c[c.length-2],r=c[c.length-1];return a===0?"N/A":`${((r-a)/a*100).toFixed(2)}%`})(t),d={chart:{type:"bar",fontFamily:"'Plus Jakarta Sans', sans-serif;",foreColor:s.palette.mode==="dark"?"#fff":"#adb0bb",toolbar:{show:!1},height:200,sparkline:{enabled:!1}},colors:["#3B80B2","#599BC8","#77ADD2","#97BEDC","#B3CEE6","#e4e9ec","#e4e9ec","#e4e9ec","#b8c0c6"],plotOptions:{bar:{borderRadius:4,columnWidth:"60%",distributed:!0,endingShape:"rounded",dataLabels:{position:"top"}}},dataLabels:{enabled:!0,formatter:function(c){return"â‚¦"+c+"m"},offsetY:-20,style:{fontSize:"12px",colors:[s.palette.mode==="dark"?"#fff":"#304758"],fontWeight:600}},legend:{show:!1},grid:{show:!1},xaxis:{categories:["July","June","May","April"],labels:{show:!0,style:{fontSize:"12px",colors:s.palette.mode==="dark"?"#fff":"#304758"}},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{show:!1}},tooltip:{enabled:!1},title:{text:"",align:"center",style:{fontSize:"12px",fontWeight:"bold",color:"#263238",padding:"10px"}}},b=[{name:"Total Cost",data:t}];return e.jsx(N,{children:e.jsxs(T,{sx:{p:"30px"},children:[e.jsxs(C,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(x,{variant:"h5",children:i}),e.jsx(F,{label:l||"Select a state",size:"small"})]}),e.jsxs(o,{container:!0,spacing:2,children:[e.jsxs(o,{item:!0,xs:12,children:[e.jsx(x,{variant:"h4",mt:3,fontWeight:600,children:n}),e.jsxs(w,{direction:"row",spacing:1,mt:1,alignItems:"center",children:[e.jsx(J,{sx:{bgcolor:"success.light",width:20,height:20},children:h.startsWith("-")?e.jsx(z,{width:16,color:"#d32f2f"}):e.jsx(K,{width:16,color:"#39b69a"})}),e.jsx(x,{variant:"subtitle2",color:"textSecondary",children:h})]})]}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx(x,{mb:2,variant:"subtitle2",whiteSpace:"nowrap",fontWeight:600,textAlign:"center",children:"Past Four Months"}),e.jsx(C,{mt:2,children:e.jsx(M,{options:d,series:b,type:"bar",height:"200px"})})]})]})]})})},y={NG018:{name:"Jigawa",energyDelivered:[500,520,540,560],energyBilled:[480,500,520,540],collections:[350,360,370,380],atcc:[56,57,58,59],billingEfficiency:[71,72,73,74],collectionEfficiency:[58,59,60,61]},NG020:{name:"Kano",energyDelivered:[700,720,740,760],energyBilled:[680,700,720,740],collections:[450,460,470,480],atcc:[60,61,62,63],billingEfficiency:[74,75,76,77],collectionEfficiency:[62,63,64,65]},NG021:{name:"Katsina",energyDelivered:[300,320,340,360],energyBilled:[280,300,320,340],collections:[250,260,270,280],atcc:[53,54,55,56],billingEfficiency:[68,69,70,71],collectionEfficiency:[65,66,67,68]}};v.accessToken="pk.eyJ1IjoiZHZvLXJlZ2lzIiwiYSI6ImNseXNsdzYzZTBsMTYycnM2bXY5dDh2M2sifQ.w7XKnvlxVxtWiYIFEVbz2g";const I=({selectedState:i,onStateClick:n})=>{const[t,l]=f.useState(null),s=E(),p=s.palette.primary.main,h=f.useRef(null),d=f.useRef(null),b=8.582,c=12.075;return f.useEffect(()=>{if(!d.current){console.log("Initializing map...");const a=new v.Map({container:h.current,style:"mapbox://styles/dvo-regis/clyssb5i7002301pc2fajh6kt",center:[b,c],zoom:6.6});d.current=a,d.current.scrollZoom.disable(),a.touchZoomRotate.enable(),a.touchZoomRotate.enableRotation(),a.dragRotate.enable(),a.boxZoom.enable(),a.keyboard.enable(),a.on("load",()=>{console.log("Map loaded"),a.addSource("states",{type:"geojson",data:"/assets/map-data/KEDC.geojson"}),a.addLayer({id:"states-layer",type:"fill",source:"states",paint:{"fill-color":"#888888","fill-opacity":.5}}),a.on("click","states-layer",r=>{if(console.log("Map clicked",r),r.features.length>0){const m=r.features[0],g=m.properties.admin1Pcod;if(console.log("Selected feature",m),g){const S=y[g]||{name:"Unknown",energyDelivered:[0,0,0,0],energyBilled:[0,0,0,0],collections:[0,0,0,0],atcc:[0],billingEfficiency:[0],collectionEfficiency:[0]};l(S),n(S.name),a.setPaintProperty("states-layer","fill-color",["case",["==",["get","admin1Pcod"],g],p,"#888888"])}else console.error("Selected property code is undefined")}}),a.on("mouseenter","states-layer",()=>{a.getCanvas().style.cursor="pointer"}),a.on("mouseleave","states-layer",()=>{a.getCanvas().style.cursor=""})})}return()=>{console.log("Cleaning up map initialization effect")}},[s,p,n]),f.useEffect(()=>{if(!d.current)return;console.log("Updating map layer for selectedState:",i);const a=d.current,r=()=>{const m=Object.keys(y).find(g=>y[g].name===i);m?(console.log("Setting fill color for selectedPcod:",m),a.setPaintProperty("states-layer","fill-color",["case",["==",["get","admin1Pcod"],m],p,"#888888"])):(console.log("Resetting fill color"),a.setPaintProperty("states-layer","fill-color","#888888"))};a.isStyleLoaded()?r():a.once("styledata",r)},[i,p]),f.useEffect(()=>{if(console.log("Selected state changed:",i),i){const a=Object.values(y).find(r=>r.name===i);l(a),console.log("State data:",a)}else l(null)},[i]),e.jsx(P,{title:"Commercial Breakdown By State",subtitle:"Select a state",children:e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(C,{className:"rounded-bars",bgcolor:"#f7f8f9",height:350,ref:h})}),t&&e.jsxs(e.Fragment,{children:[e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(u,{title:"Energy Delivered",value:`${t.energyDelivered[t.energyDelivered.length-1]} GWh`,chartData:t.energyDelivered,stateName:t.name})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(u,{title:"Energy Billed",value:`${t.energyBilled[t.energyBilled.length-1]} GWh`,chartData:t.energyBilled,stateName:t.name})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(u,{title:"Collections",value:`${t.collections[t.collections.length-1]} GWh`,chartData:t.collections,stateName:t.name})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(u,{title:"ATCC",value:`${t.atcc[t.atcc.length-1]}%`,chartData:t.atcc,stateName:t.name})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(u,{title:"Billing Efficiency",value:`${t.billingEfficiency[t.billingEfficiency.length-1]}%`,chartData:t.billingEfficiency,stateName:t.name})}),e.jsx(o,{item:!0,xs:12,sm:4,children:e.jsx(u,{title:"Collection Efficiency",value:`${t.collectionEfficiency[t.collectionEfficiency.length-1]}%`,chartData:t.collectionEfficiency,stateName:t.name})})]})]})})},j=W(L)(({theme:i})=>({borderRadius:0,"&:first-of-type":{borderTopLeftRadius:i.shape.borderRadius,borderBottomLeftRadius:i.shape.borderRadius},"&:last-of-type":{borderTopRightRadius:i.shape.borderRadius,borderBottomRightRadius:i.shape.borderRadius},"&:not(:first-of-type)":{marginLeft:"-1px"}})),D=({onFilterChange:i,selectedState:n})=>{const t=l=>{i(n===l?"":l)};return e.jsxs(w,{direction:"row",children:[e.jsx(j,{variant:n==="Kano"?"contained":"outlined",onClick:()=>t("Kano"),children:"Kano"}),e.jsx(j,{variant:n==="Katsina"?"contained":"outlined",onClick:()=>t("Katsina"),children:"Katsina"}),e.jsx(j,{variant:n==="Jigawa"?"contained":"outlined",onClick:()=>t("Jigawa"),children:"Jigawa"})]})};D.propTypes={onFilterChange:B.func.isRequired,selectedState:B.string.isRequired};const Z=[{to:"/",title:"Home"},{title:"State"},{title:"Commercial by State"}],le=()=>{const[i,n]=f.useState(""),t=s=>{n(s)},l=s=>{n(s)};return e.jsxs(k,{title:"Commercial By State",description:"This is Charts page",children:[e.jsx(R,{title:"Commercial by State",items:Z}),e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(D,{onFilterChange:l,selectedState:i})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(I,{selectedState:i,onStateClick:t})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(G,{})})]})]})};export{le as default};
